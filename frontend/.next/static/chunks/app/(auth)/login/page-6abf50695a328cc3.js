(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[665],{474:function(e,t,r){Promise.resolve().then(r.bind(r,8960))},8960:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var a=r(7437),s=r(2265),n=r(4033),l=r(1396),o=r.n(l),i=r(4302),c=r(345);function u(){let[e,t]=(0,s.useState)(""),[r,l]=(0,s.useState)(""),[u,d]=(0,s.useState)(""),[h,g]=(0,s.useState)(!1),m=(0,n.useRouter)(),{login:x}=(0,i.a)(),f=async t=>{if(t.preventDefault(),d(""),!(0,c.oH)(e)){d("Please enter a valid email");return}if(!r){d("Password is required");return}g(!0);try{await x(e,r),m.push("/dashboard"),m.refresh()}catch(e){d("Invalid email or password")}finally{g(!1)}};return(0,a.jsx)("div",{className:"min-h-screen w-full flex items-center justify-center bg-black bg-[radial-gradient(ellipse_at_top,_rgba(255,255,255,0.05),_transparent_60%)]",children:(0,a.jsxs)("div",{className:"w-full max-w-sm rounded-2xl border border-white/10 bg-black/90 px-8 py-10 shadow-2xl",children:[(0,a.jsx)("div",{className:"text-center mb-8",children:(0,a.jsx)("h1",{className:"text-lg font-semibold text-white tracking-wide",children:"Todo App"})}),(0,a.jsx)("h2",{className:"text-center text-2xl font-bold text-white mb-8",children:"Sign in"}),(0,a.jsxs)("form",{onSubmit:f,className:"space-y-6",children:[u&&(0,a.jsx)("div",{className:"rounded-md border border-red-500/30 bg-red-500/10 p-3",children:(0,a.jsx)("p",{className:"text-sm text-red-400",children:u})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-zinc-400 mb-2",children:"Email"}),(0,a.jsx)("input",{type:"email",value:e,onChange:e=>t(e.target.value),className:"w-full rounded-lg border border-white/15 bg-black px-4 py-3 text-white placeholder-zinc-500 focus:border-white/40 focus:ring-2 focus:ring-white/10 outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs text-zinc-400 mb-2",children:"Password"}),(0,a.jsx)("input",{type:"password",value:r,onChange:e=>l(e.target.value),className:"w-full rounded-lg border border-white/15 bg-black px-4 py-3 text-white placeholder-zinc-500 focus:border-white/40 focus:ring-2 focus:ring-white/10 outline-none"})]}),(0,a.jsx)("button",{type:"submit",disabled:h,className:"mt-4 w-full rounded-lg bg-white py-3.5 text-sm font-semibold text-black hover:bg-zinc-200 transition disabled:opacity-50",children:h?"Signing in…":"Sign in"})]}),(0,a.jsxs)("div",{className:"mt-8 text-center space-y-3",children:[(0,a.jsx)(o(),{href:"/signup",className:"text-sm text-zinc-400 hover:text-white",children:"Do not have an account? Sign up"}),(0,a.jsx)("div",{children:(0,a.jsx)(o(),{href:"/",className:"text-xs text-zinc-500 hover:text-white",children:"← Back to home"})})]})]})})}},4302:function(e,t,r){"use strict";r.d(t,{a:function(){return u}});var a=r(2265),s=r(4829),n=r(2601);let l=n.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000",o="auth_user",i="jwt_token",c={login:async(e,t)=>{try{let r=await s.Z.post("".concat(l,"/auth/login"),{email:e,password:t},{headers:{"Content-Type":"application/json"}}),{user:a,token:n}=r.data;return localStorage.setItem(i,n),localStorage.setItem(o,JSON.stringify(a)),{user:a,token:n}}catch(e){if(s.Z.isAxiosError(e)){var r,a;throw Error((null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)||"Login failed")}throw e}},signup:async(e,t,r)=>{try{let a=await s.Z.post("".concat(l,"/auth/signup"),{username:r,email:e,password:t},{headers:{"Content-Type":"application/json"}}),{user:n,token:c}=a.data;return localStorage.setItem(i,c),localStorage.setItem(o,JSON.stringify(n)),{user:n,token:c}}catch(e){if(s.Z.isAxiosError(e)){var a,n;throw Error((null===(n=e.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.message)||"Signup failed")}throw e}},logout:async()=>(localStorage.removeItem(i),localStorage.removeItem(o),{message:"Successfully logged out"}),getCurrentSession:async()=>{let e=localStorage.getItem(i),t=localStorage.getItem(o);if(!e||!t)return null;try{return{token:e,user:JSON.parse(t)}}catch(e){return localStorage.removeItem(i),localStorage.removeItem(o),null}},isAuthenticated:()=>!!localStorage.getItem(i)},u=()=>{let[e,t]=(0,a.useState)(null),[r,s]=(0,a.useState)(!1),[n,l]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=async()=>{try{let e=await c.getCurrentSession();e?(t(e.user),s(!0)):(t(null),s(!1))}catch(e){console.error("Error checking auth status:",e),t(null),s(!1)}finally{l(!1)}};e()},[]);let o=async(e,r)=>{try{let a=await c.login(e,r);return t(a.user),s(!0),a}catch(e){throw e}},i=async(e,r,a)=>{try{let n=await c.signup(e,r,a);return t(n.user),s(!0),n}catch(e){throw e}},u=async()=>{try{await c.logout(),t(null),s(!1)}catch(e){console.error("Error during logout:",e)}};return{user:e,isAuthenticated:r,isLoading:n,login:o,signup:i,logout:u}}},345:function(e,t,r){"use strict";r.d(t,{oH:function(){return a},uo:function(){return s}});let a=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),s=e=>/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{8,}$/.test(e)}},function(e){e.O(0,[600,396,971,472,744],function(){return e(e.s=474)}),_N_E=e.O()}]);